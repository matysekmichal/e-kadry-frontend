<section class="card-bar border-b">
  <div class="flex justify-between w-full">
    <h2 class="text-xl font-semibold flex items-center">Pracownicy</h2>
    <label for="search" class="table-search">
      <ic-icon [icIcon]="icSearch" size="22px"></ic-icon>
      <input id="search" type="search" [formControl]="searchControl" placeholder="Szukaj ..." aria-label="Szukaj">
    </label>
  </div>
</section>

<section [class.hidden]="dataSource?.isEmpty || (service.filter$ | async)">
  <table [dataSource]="dataSource" class="w-full" mat-table>
    <ng-container matColumnDef="name">
      <th class="uppercase" *matHeaderCellDef mat-header-cell>Imię i nazwisko</th>
      <td *matCellDef="let row" mat-cell>
        <span>{{ row.firstName }} {{ row.lastName }}</span> &nbsp;
      </td>
    </ng-container>

    <ng-container matColumnDef="action">
      <th class="w-0" *matHeaderCellDef mat-header-cell></th>
      <td *matCellDef="let row" mat-cell>
        <div *ngIf="workerId;then SelectWorker else NotSelectedWorker"></div>
        <ng-template #NotSelectedWorker>
          <mat-icon [icIcon]="icMore" size="22px"></mat-icon>
        </ng-template>

        <ng-template #SelectWorker>
          <mat-icon [icIcon]="icCancel" size="22px"></mat-icon>
        </ng-template>
      </td>
    </ng-container>

    <tr *matHeaderRowDef="visibleColumns" mat-header-row></tr>
    <tr class="hover:bg-gray-100 cursor-pointer transition-colors"
        [class.active]="row.id == workerId"
        *matRowDef="let row; columns: visibleColumns;"
        (click)="selectWorker(row)"
        mat-row></tr>
  </table>

  <mat-paginator [pageSizeOptions]="pageSizeOptions"
                 [pageSize]="(dataSource.data$ | async).perPage"
                 [length]="(dataSource.data$ | async).total"
                 [showFirstLastButtons]="true">
  </mat-paginator>
</section>

<div *ngIf="service.filter$ | async;then filtering else notFiltering"></div>
<ng-template #filtering>
  <div class="table-message">
    <mat-progress-spinner mode="indeterminate" color="primary" diameter="56"></mat-progress-spinner>
  </div>
</ng-template>
<ng-template #notFiltering>
  <div class="table-message" *ngIf="dataSource.isEmpty">
    Nie znaleziono pracowników
  </div>
</ng-template>
